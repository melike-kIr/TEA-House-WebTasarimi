<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Tea House - √úr√ºn Y√∂netimi</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

    <link href="css/admin_style.css" rel="stylesheet">

    <style>
        .form-card {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            border: 1px solid #dee2e6;
        }

        .product-list-card img {
            transition: transform 0.3s ease;
        }
        .product-list-card:hover img {
            transform: scale(1.05);
        }
                .copyright-admin {
            margin-left: 250px; 
            background-color: #aa98ca7e; 
            border-top: 1px solid #e9ecef;
            padding: 1rem 0;
            width: calc(100% - 250px);
        }
    </style>
</head>

<body>

    <div class="sidebar bg-dark text-white p-3">
        <h3 class="mb-5 text-center border-bottom pb-3">üçµ Tea House Admin</h3>
        <a href="manager.html"><i class="bi bi-grid-fill me-2"></i> Dashboard</a>
        <a href="manager_product.html" class="active"><i class="bi bi-box-seam me-2"></i> √úr√ºn Y√∂netimi</a>
        <a href="manager_announcement.html"><i class="bi bi-megaphone me-2"></i> Duyurular</a>
        <a href="manager-users.html"><i class="bi bi-people me-2"></i> Aboneler</a>
        
        <div class="mt-5 pt-5 border-top">
            <a href="index.html" class="mt-4"><i class="bi bi-box-arrow-left me-2"></i> √áƒ±kƒ±≈ü Yap</a>
        </div>
    </div>


    <div class="content p-5">
        <h1 class="display-6 fw-bold mb-4 border-bottom pb-2">√úr√ºn Y√∂netimi</h1>

        <div class="form-card mb-5">
            <h3 class="mb-4 text-primary"><i class="bi bi-plus-circle-fill me-2"></i> Yeni √úr√ºn Ekle / D√ºzenle</h3>
            
            <form id="productCreatorForm">
                <input type="hidden" id="productId"> 

                <div class="row g-3">
                    <div class="col-md-4">
                        <label for="inputName" class="form-label">√úr√ºn Adƒ± *</label>
                        <input type="text" class="form-control" id="productName" required value="Sencha √áayƒ±">
                    </div>
                    <div class="col-md-4">
                        <label for="inputPrice" class="form-label">Fiyat (‚Ç∫) *</label>
                        <div class="input-group">
                            <span class="input-group-text">‚Ç∫</span>
                            <input type="number" class="form-control" id="productPrice" required min="0" step="0.01" value="19.00">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <label for="inputStock" class="form-label">Stok Miktarƒ±</label>
                        <input type="number" class="form-control" id="productStock" min="0" value="10">
                    </div>
                    <div class="col-md-6">
                        <label for="inputCategory" class="form-label">Kategori (√ñrn: green-tea)</label>
                        <input type="text" class="form-control" id="productCategory" value="green-tea">
                    </div>
                    <div class="col-md-6">
                        <label for="inputImage" class="form-label">G√∂rsel Yolu * (√ñrn: img/sencha.png)</label>
                        <input class="form-control" id="productImage" required placeholder="img/sencha.png" value="img/sencha.png">
                    </div>
                </div>

                <div class="mt-3">
                    <label for="inputDescription" class="form-label">A√ßƒ±klama *</label>
                    <textarea class="form-control" id="productDescription" rows="4" required>Sencha Tea, Japon k√ºlt√ºr√ºne ait yƒ±lƒ±n ilk hasatlarƒ± toplanarak elde edilen bir ye≈üil √ßaydƒ±r.</textarea>
                </div>
                
                <div class="mt-4">
                    <button type="submit" class="btn btn-success btn-lg me-2" id="saveButton"><i class="bi bi-floppy me-2"></i> √úr√ºn√º Kaydet</button>
                    <button type="button" class="btn btn-outline-secondary btn-lg" onclick="document.getElementById('productCreatorForm').reset();"><i class="bi bi-arrow-counterclockwise me-2"></i> Formu Temizle</button>
                </div>
            </form>
        </div>
        
        <div id="messageArea" class="mt-4"></div>

        <h3 class="mt-5 mb-4 border-bottom pb-2">Kaydedilen √úr√ºnler Listesi</h3>
        
        <div id="productList" class="mb-5">
            </div>
    </div>
    <div class="container-fluid copyright-admin py-4">
        <div class="container-fluid">
            <div class="row px-5">
                <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
                    &copy; <a class="fw-medium" href="#">√áay Satƒ±≈ü Sitesi</a>, Melike KIR. T√ºm Haklarƒ± Saklƒ±dƒ±r.
                </div>
                <div class="col-md-6 text-center text-md-end">
                    Geli≈ütirme: Melike KIR  | Tema Kaynaƒüƒ±: <a class="fw-medium" href="https://themewagon.com">ThemeWagon</a>
                </div>
            </div>
        </div>
    </div>


<script>

function getProducts() {
    const data = localStorage.getItem("products");
    return data ? JSON.parse(data) : [];
}

function saveProducts(list) {
    localStorage.setItem("products", JSON.stringify(list));
}

function createProduct(name, price, category, image, description, stock) {
    let products = getProducts();
    const productIdInput = document.getElementById("productId").value;

    if (productIdInput) {

        let index = products.findIndex(p => p.productId == productIdInput);
        if (index !== -1) {
            products[index] = {
                productId: products[index].productId,
                name,
                price: parseFloat(price),
                image,
                description,
                category,
                stock: parseInt(stock) || 0
            };
            saveProducts(products);
            document.getElementById('messageArea').innerHTML =
                `<div class="alert alert-warning">"${name}" ba≈üarƒ±yla **g√ºncellendi**.</div>`;
            document.getElementById("productId").value = ""; 
            document.getElementById("saveButton").innerText = "√úr√ºn√º Kaydet";

        }
    } else {
        let product = {
            productId: Date.now(),
            name: name,
            price: parseFloat(price),
            image: image,
            description: description,
            category: category,
            stock: parseInt(stock) || 0
        };

        products.push(product);
        saveProducts(products);

        document.getElementById('messageArea').innerHTML =
            `<div class="alert alert-success">"${name}" ba≈üarƒ±yla kaydedildi.</div>`;
    }

    renderProductList();
    document.getElementById('productCreatorForm').reset();
}

function renderProductList() {
    const list = getProducts();
    const area = document.getElementById("productList");

    if (list.length === 0) {
        area.innerHTML = `<div class="alert alert-info border-0 shadow-sm p-4"><i class="bi bi-info-circle-fill me-2"></i> Hen√ºz √ºr√ºn eklenmedi. L√ºtfen yukarƒ±daki formu kullanarak bir √ºr√ºn ekleyin.</div>`;
        return;
    }

    let html = `<div class="row g-4">`;

    list.forEach(p => {
        const stockBadge = p.stock > 0 ? 
            `<span class="badge bg-success">Stokta (${p.stock})</span>` :
            `<span class="badge bg-danger">T√ºkendi</span>`;
            
        html += `
        <div class="col-xl-3 col-lg-4 col-md-6">
            <div class="card shadow-sm border-0 product-list-card h-100">
                <img src="${p.image}" class="card-img-top p-2 rounded-top" style="height:180px; object-fit:cover;">
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title fw-bold text-primary">${p.name}</h5>
                    <p class="card-text text-muted mb-1">${p.price} ‚Ç∫</p>
                    ${stockBadge}

                    <div class="d-flex justify-content-between mt-3 pt-2 border-top">
                        <a href="product-detail.html?productId=${p.productId}" 
                            class="btn btn-sm btn-outline-primary" target="_blank">
                            <i class="bi bi-eye"></i> G√∂r
                        </a>

                        <button class="btn btn-sm btn-warning" onclick="editProduct(${p.productId})">
                            <i class="bi bi-pencil"></i> D√ºzenle
                        </button>

                        <button class="btn btn-sm btn-danger" onclick="deleteProduct(${p.productId})">
                            <i class="bi bi-trash"></i> Sil
                        </button>
                    </div>
                </div>
            </div>
        </div>`;
    });

    html += `</div>`;
    area.innerHTML = html;
}

function deleteProduct(id) {
    if (!confirm("Bu √ºr√ºn√º silmek istediƒüine emin misiniz?")) return;

    let list = getProducts();
    list = list.filter(p => p.productId !== id);

    saveProducts(list);
    renderProductList();
}

function editProduct(id) {
    const p = getProducts().find(x => x.productId === id);

    document.getElementById("productId").value = p.productId;
    document.getElementById("productName").value = p.name;
    document.getElementById("productPrice").value = p.price;
    document.getElementById("productCategory").value = p.category;
    document.getElementById("productImage").value = p.image;
    document.getElementById("productDescription").value = p.description;
    document.getElementById("productStock").value = p.stock;

    document.getElementById("saveButton").innerHTML = '<i class="bi bi-arrow-up-circle me-2"></i> √úr√ºn√º G√ºncelle';
    document.getElementById('messageArea').innerHTML =
        `<div class="alert alert-warning">**${p.name}** √ºr√ºn√º d√ºzenleniyor. Deƒüi≈üiklikleri kaydetmek i√ßin **G√ºncelle** butonuna tƒ±klayƒ±n.</div>`;

    window.scrollTo({ top: 0, behavior: 'smooth' });
}


document.addEventListener("DOMContentLoaded", () => {


    renderProductList();

    document.getElementById("productCreatorForm").addEventListener("submit", (e) => {
        e.preventDefault();


        const name = productName.value.trim();
        const price = productPrice.value.trim();
        const category = productCategory.value.trim();
        const image = productImage.value.trim();
        const description = productDescription.value.trim();
        const stock = productStock.value.trim();

        createProduct(name, price, category, image, description, stock);
    });
});
</script>


</body>
</html>