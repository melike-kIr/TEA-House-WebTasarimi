<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Ürün Veri Oluşturucu</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { padding-top: 30px; background-color: #f8f9fa; }
        .container { max-width: 800px; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    </style>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">
    <link href="css/admin_style.css" rel="stylesheet">
</head>
<body>
    <div class="sidebar">
        <h3>Tea House Admin</h3>
        <a href="#"><i class="bi bi-speedometer2 me-2"></i> Dashboard</a>
        <a href="manager_product.html"><i class="bi bi-box-seam me-2"></i> Ürün Yönetimi</a>
        <a href="manager_announcement.html"><i class="bi bi-megaphone me-2"></i> Duyurular</a>
        <a href="slider.html"><i class="bi bi-images me-2"></i> Slider Yönetimi</a>
        <a href="orders.html"><i class="bi bi-cart-check me-2"></i> Siparişler</a>
        <a href="users.html"><i class="bi bi-people me-2"></i> Kullanıcılar</a>
        <a href="index.html"><i class="bi bi-box-arrow-right me-2"></i> Çıkış</a>
    </div>
<div class="content">
    <h1 class="mb-4 text-primary">Ürün Veri Oluşturucu (Local Storage)</h1>
    <p class="text-muted">Burada eklediğiniz ürünler, detay sayfanızda görünmesi için tarayıcınızın Local Storage'ına ('products' anahtarı ile) kaydedilecektir.</p>

    <form id="productCreatorForm">
        <input type="hidden" id="productId"> 

        <div class="row">
            <div class="col-md-4 mb-3">
                <label for="inputName" class="form-label">Ürün Adı *</label>
                <input type="text" class="form-control" id="productName" required value="Sencha Çayı">
            </div>
            <div class="col-md-4 mb-3">
                <label for="inputPrice" class="form-label">Fiyat (₺) *</label>
                <input type="number" class="form-control" id="productPrice" required min="0" step="0.01" value="19.00">
            </div>
            <div class="col-md-4 mb-3">
                <label for="inputCategory" class="form-label">Kategori</label>
                <input type="text" class="form-control" id="productCategory" value="green-tea">
            </div>
        </div>

        <div class="mb-3">
            <label for="inputImage" class="form-label">Görseli *</label>
            <input  class="form-control" id="productImage" required placeholder="img/sencha.png" value="img/sencha.png">
        </div>
        
        <div class="mb-3">
            <label for="inputDescription" class="form-label">Açıklama *</label>
            <textarea class="form-control" id="productDescription" rows="3" required>Sencha Tea, Japon kültürüne ait yılın ilk hasatları toplanarak elde edilen bir yeşil çaydır.</textarea>
        </div>
        
        <div class="mb-3">
            <label for="inputStock" class="form-label">Stok Miktarı</label>
            <input type="number" class="form-control" id="productStock" min="0" value="10">
        </div>
        
        <button type="submit" class="btn btn-primary btn-lg" id="saveButton">Ürünü Kaydet</button>
        <button type="button" class="btn btn-secondary btn-lg" onclick="document.getElementById('productCreatorForm').reset();">Formu Temizle</button>
    </form>

    <div id="messageArea" class="mt-4"></div>

    <hr class="my-4">

    <h3 class="mb-3">Kaydedilen Ürünler (Test Alanı)</h3>
    <div id="productList"></div>
</div>


<script>
// =============================
// LOCAL STORAGE FONKSİYONLARI
// =============================
function getProducts() {
    const data = localStorage.getItem("products");
    return data ? JSON.parse(data) : [];
}

function saveProducts(list) {
    localStorage.setItem("products", JSON.stringify(list));
}

// =============================
// ÜRÜN EKLEME / GÜNCELLEME
// =============================
function createProduct(name, price, category, image, description, stock) {
    let products = getProducts();

    let product = {
        productId: Date.now(),  // Benzersiz ID
        name: name,
        price: parseFloat(price),
        image: image,
        description: description,
        category: category,
        stock: parseInt(stock) || 0
    };

    products.push(product);
    saveProducts(products);

    document.getElementById('messageArea').innerHTML =
        `<div class="alert alert-success">"${name}" başarıyla kaydedildi.</div>`;

    renderProductList();
}

// =============================
// ÜRÜNLERİ LİSTELEME
// =============================
function renderProductList() {
    const list = getProducts();
    const area = document.getElementById("productList");

    if (list.length === 0) {
        area.innerHTML = `<div class="alert alert-info">Henüz ürün eklenmedi.</div>`;
        return;
    }

    let html = `<div class="row g-4">`;

    list.forEach(p => {
        html += `
        <div class="col-md-4">
            <div class="card shadow-sm border-0">
                <img src="${p.image}" class="card-img-top" style="height:220px; object-fit:contain;">
                <div class="card-body">
                    <h5 class="card-title fw-bold">${p.name}</h5>
                    <p class="card-text text-muted">${p.price} ₺</p>
                    <span class="badge bg-secondary mb-2">Stok: ${p.stock}</span>

                    <div class="d-flex justify-content-between mt-3">
                        <a href="product-detail.html?productId=${p.productId}" 
                           class="btn btn-sm btn-outline-primary">
                           <i class="bi bi-eye"></i> Detay
                        </a>

                        <button class="btn btn-sm btn-warning" onclick="editProduct(${p.productId})">
                            <i class="bi bi-pencil"></i> Düzenle
                        </button>

                        <button class="btn btn-sm btn-danger" onclick="deleteProduct(${p.productId})">
                            <i class="bi bi-trash"></i> Sil
                        </button>
                    </div>
                </div>
            </div>
        </div>`;
    });

    html += `</div>`;
    area.innerHTML = html;
}

// =============================
// ÜRÜN SİLME
// =============================
function deleteProduct(id) {
    if (!confirm("Bu ürünü silmek istediğine emin misiniz?")) return;

    let list = getProducts();
    list = list.filter(p => p.productId !== id);

    saveProducts(list);
    renderProductList();
}

// =============================
// ÜRÜN DÜZENLEME
// =============================
function editProduct(id) {
    const p = getProducts().find(x => x.productId === id);

    document.getElementById("productId").value = p.productId;
    document.getElementById("productName").value = p.name;
    document.getElementById("productPrice").value = p.price;
    document.getElementById("productCategory").value = p.category;
    document.getElementById("productImage").value = p.image;
    document.getElementById("productDescription").value = p.description;
    document.getElementById("productStock").value = p.stock;

    document.getElementById("saveButton").innerText = "Ürünü Güncelle";
}

// =============================
// FORM SUBMIT
// =============================
document.addEventListener("DOMContentLoaded", () => {

    renderProductList();

    document.getElementById("productCreatorForm").addEventListener("submit", (e) => {
        e.preventDefault();

        const name = productName.value.trim();
        const price = productPrice.value.trim();
        const category = productCategory.value.trim();
        const image = productImage.value.trim();
        const description = productDescription.value.trim();
        const stock = productStock.value.trim();

        createProduct(name, price, category, image, description, stock);
    });
});
</script>


</body>
</html>